<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Admin | Traveling Tastebuds</title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="toast-container" id="toastContainer"></div>

    <!-- LOGIN SCREEN -->
    <div class="admin-login-wrapper" id="loginScreen">
        <div class="admin-login-card">
            <img src="/Images/ttbLogo.png" alt="TTB Logo">
            <h2>TTB Admin</h2>
            <p class="subtitle">Enter your password to manage spots</p>
            <form id="loginForm" autocomplete="off">
                <input type="password" class="form-control mb-3" id="loginPassword" placeholder="Password" required autocomplete="current-password">
                <button type="submit" class="btn-ttb btn-ttb-primary" id="loginBtn" style="width:100%;justify-content:center;border:none;font-size:1rem;">
                    <i class="fas fa-plug"></i> <span>Wake Up Server & Log In</span>
                </button>
                <p id="loginStatus" style="font-size:0.8rem; color:var(--text-muted); margin:0.75rem 0 0 0; min-height:1.2em; text-align:center;"></p>
            </form>
            <p style="color:var(--text-muted);font-size:0.75rem;margin-top:1.5rem;margin-bottom:0;">
                <a href="/" style="color:var(--header-color);text-decoration:none;">&larr; Back to site</a>
            </p>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div class="admin-dashboard" id="dashboard">
        <div class="admin-topbar">
            <div class="admin-topbar-left">
                <img src="/Images/ttbLogo.png" alt="TTB">
                <h1>Dashboard</h1>
                <span class="admin-badge">ADMIN</span>
            </div>
            <div style="display:flex;gap:0.5rem;align-items:center;">
                <button class="btn-ttb btn-ttb-accent" style="padding:0.4rem 1rem;font-size:0.8rem;" onclick="handleExportData()"><i class="fas fa-download"></i> Export Data</button>
                <a href="/" class="btn-ttb btn-ttb-outline" style="padding:0.4rem 1rem;font-size:0.8rem;"><i class="fas fa-external-link-alt"></i> View Site</a>
                <button class="btn-ttb btn-ttb-outline" style="padding:0.4rem 1rem;font-size:0.8rem;" onclick="handleLogout()"><i class="fas fa-sign-out-alt"></i> Log Out</button>
            </div>
        </div>
        <div class="admin-tabs">
            <button class="admin-tab active" id="tabSpots" onclick="switchTab('spots')"><i class="fas fa-utensils"></i> Spots <span class="tab-count" id="tabSpotsCount">0</span></button>
            <button class="admin-tab" id="tabTestimonials" onclick="switchTab('testimonials')"><i class="fas fa-quote-left"></i> Testimonials <span class="tab-count" id="tabTestimonialsCount">0</span></button>
            <button class="admin-tab" id="tabPricing" onclick="switchTab('pricing')"><i class="fas fa-tag"></i> Pricing <span class="tab-count" id="tabPricingCount">0</span></button>
        </div>

        <!-- ‚ïê‚ïê‚ïê SPOTS TAB ‚ïê‚ïê‚ïê -->
        <div id="spotsTab">
        <div class="admin-stats" id="adminStats">
            <div class="admin-stat-card"><div class="stat-number" id="statTotal">-</div><div class="stat-label">Total Spots</div></div>
            <div class="admin-stat-card"><div class="stat-number" id="statDiscounts">-</div><div class="stat-label">With Discounts</div></div>
            <div class="admin-stat-card"><div class="stat-number" id="statAvgRating">-</div><div class="stat-label">Avg Rating</div></div>
            <div class="admin-stat-card"><div class="stat-number" id="statTags">-</div><div class="stat-label">Unique Tags</div></div>
        </div>
        <div class="admin-toolbar">
            <div style="position:relative;flex:1;max-width:350px;">
                <i class="fas fa-search" style="position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted);"></i>
                <input type="text" class="admin-search" id="adminSearch" placeholder="Search spots...">
            </div>
            <div style="display:flex;gap:0.5rem;">
                <button class="btn-ttb btn-ttb-outline" style="font-size:0.85rem;padding:0.55rem 1.2rem;" onclick="handleSeedDB()"><i class="fas fa-database"></i> Seed DB</button>
                <button class="btn-ttb btn-ttb-accent" style="font-size:0.85rem;padding:0.55rem 1.2rem;" onclick="openImportModal()"><i class="fab fa-tiktok"></i> Import TikToks</button>
                <button class="btn-ttb btn-ttb-primary" style="font-size:0.85rem;padding:0.55rem 1.2rem;" onclick="openAddModal()"><i class="fas fa-plus"></i> Add Spot</button>
            </div>
        </div>
        <div class="admin-table-wrapper">
            <table class="admin-table">
                <thead><tr><th></th><th>Name</th><th>Location</th><th>Tags</th><th>Rating</th><th>Discount</th><th>Actions</th></tr></thead>
                <tbody id="spotsTableBody">
                    <tr><td colspan="7">
                        <div class="skeleton-row"><div class="skeleton skeleton-circle"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div></div>
                        <div class="skeleton-row"><div class="skeleton skeleton-circle"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div></div>
                        <div class="skeleton-row"><div class="skeleton skeleton-circle"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div></div>
                    </td></tr>
                </tbody>
            </table>
        </div>
        </div><!-- /spotsTab -->

        <!-- ‚ïê‚ïê‚ïê TESTIMONIALS TAB ‚ïê‚ïê‚ïê -->
        <div id="testimonialsTab" style="display:none;">

            <!-- Trust Stats Editor -->
            <div class="trust-stats-editor">
                <div class="trust-stats-editor-title">
                    <i class="fas fa-chart-bar"></i> Trust Stats Bar
                    <span style="font-size:0.8rem;font-weight:400;color:var(--text-muted);margin-left:0.5rem;">‚Äî These appear on the public testimonials page</span>
                </div>
                <div id="trustStatsRows">
                    <div class="trust-stat-row" data-index="0">
                        <select class="trust-stat-icon-select" data-field="icon">
                            <option value="fas fa-utensils">üç¥ Utensils</option>
                            <option value="fas fa-star">‚≠ê Star</option>
                            <option value="fas fa-eye">üëÅ Eye</option>
                            <option value="fas fa-handshake">ü§ù Handshake</option>
                            <option value="fas fa-chart-line">üìà Chart</option>
                            <option value="fas fa-users">üë• Users</option>
                            <option value="fas fa-trophy">üèÜ Trophy</option>
                            <option value="fas fa-heart">‚ù§ Heart</option>
                            <option value="fas fa-fire">üî• Fire</option>
                            <option value="fas fa-bolt">‚ö° Bolt</option>
                            <option value="fas fa-thumbs-up">üëç Thumbs Up</option>
                            <option value="fas fa-crown">üëë Crown</option>
                        </select>
                        <input type="text" class="stat-number-input" data-field="number" placeholder="50+" maxlength="15">
                        <input type="text" class="stat-label-input" data-field="label" placeholder="Restaurants Featured" maxlength="40">
                    </div>
                    <div class="trust-stat-row" data-index="1">
                        <select class="trust-stat-icon-select" data-field="icon">
                            <option value="fas fa-utensils">üç¥ Utensils</option>
                            <option value="fas fa-star" selected>‚≠ê Star</option>
                            <option value="fas fa-eye">üëÅ Eye</option>
                            <option value="fas fa-handshake">ü§ù Handshake</option>
                            <option value="fas fa-chart-line">üìà Chart</option>
                            <option value="fas fa-users">üë• Users</option>
                            <option value="fas fa-trophy">üèÜ Trophy</option>
                            <option value="fas fa-heart">‚ù§ Heart</option>
                            <option value="fas fa-fire">üî• Fire</option>
                            <option value="fas fa-bolt">‚ö° Bolt</option>
                            <option value="fas fa-thumbs-up">üëç Thumbs Up</option>
                            <option value="fas fa-crown">üëë Crown</option>
                        </select>
                        <input type="text" class="stat-number-input" data-field="number" placeholder="5.0" maxlength="15">
                        <input type="text" class="stat-label-input" data-field="label" placeholder="Average Rating" maxlength="40">
                    </div>
                    <div class="trust-stat-row" data-index="2">
                        <select class="trust-stat-icon-select" data-field="icon">
                            <option value="fas fa-utensils">üç¥ Utensils</option>
                            <option value="fas fa-star">‚≠ê Star</option>
                            <option value="fas fa-eye" selected>üëÅ Eye</option>
                            <option value="fas fa-handshake">ü§ù Handshake</option>
                            <option value="fas fa-chart-line">üìà Chart</option>
                            <option value="fas fa-users">üë• Users</option>
                            <option value="fas fa-trophy">üèÜ Trophy</option>
                            <option value="fas fa-heart">‚ù§ Heart</option>
                            <option value="fas fa-fire">üî• Fire</option>
                            <option value="fas fa-bolt">‚ö° Bolt</option>
                            <option value="fas fa-thumbs-up">üëç Thumbs Up</option>
                            <option value="fas fa-crown">üëë Crown</option>
                        </select>
                        <input type="text" class="stat-number-input" data-field="number" placeholder="10M+" maxlength="15">
                        <input type="text" class="stat-label-input" data-field="label" placeholder="Total Views" maxlength="40">
                    </div>
                    <div class="trust-stat-row" data-index="3">
                        <select class="trust-stat-icon-select" data-field="icon">
                            <option value="fas fa-utensils">üç¥ Utensils</option>
                            <option value="fas fa-star">‚≠ê Star</option>
                            <option value="fas fa-eye">üëÅ Eye</option>
                            <option value="fas fa-handshake" selected>ü§ù Handshake</option>
                            <option value="fas fa-chart-line">üìà Chart</option>
                            <option value="fas fa-users">üë• Users</option>
                            <option value="fas fa-trophy">üèÜ Trophy</option>
                            <option value="fas fa-heart">‚ù§ Heart</option>
                            <option value="fas fa-fire">üî• Fire</option>
                            <option value="fas fa-bolt">‚ö° Bolt</option>
                            <option value="fas fa-thumbs-up">üëç Thumbs Up</option>
                            <option value="fas fa-crown">üëë Crown</option>
                        </select>
                        <input type="text" class="stat-number-input" data-field="number" placeholder="100%" maxlength="15">
                        <input type="text" class="stat-label-input" data-field="label" placeholder="Satisfaction" maxlength="40">
                    </div>
                </div>
                <div class="trust-stats-actions">
                    <button class="btn-ttb btn-ttb-primary" onclick="saveTrustStats()" style="font-size:0.85rem;padding:0.55rem 1.2rem;">
                        <i class="fas fa-save"></i> Save Trust Stats
                    </button>
                </div>
            </div>

            <!-- Testimonials Toolbar -->
            <div class="admin-toolbar">
                <div style="position:relative;flex:1;max-width:350px;">
                    <i class="fas fa-search" style="position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--text-muted);"></i>
                    <input type="text" class="admin-search" id="testimonialSearch" placeholder="Search testimonials...">
                </div>
                <div style="display:flex;gap:0.5rem;">
                    <button class="btn-ttb btn-ttb-primary" style="font-size:0.85rem;padding:0.55rem 1.2rem;" onclick="openAddTestimonialModal()"><i class="fas fa-plus"></i> Add Testimonial</button>
                </div>
            </div>

            <!-- Testimonials Grid -->
            <div class="testimonial-admin-grid" id="testimonialsGrid">
                <div class="testimonial-admin-card" style="opacity:0.5;text-align:center;padding:3rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size:1.5rem;color:var(--text-muted);"></i>
                    <p style="color:var(--text-muted);margin-top:1rem;">Loading testimonials...</p>
                </div>
            </div>
        </div><!-- /testimonialsTab -->

        <!-- ‚ïê‚ïê‚ïê PRICING TAB ‚ïê‚ïê‚ïê -->
        <div id="pricingTab" style="display:none;">

            <!-- Pricing Stats -->
            <div class="admin-stats" id="pricingStats">
                <div class="admin-stat-card"><div class="stat-number" id="statPackages">-</div><div class="stat-label">Packages</div></div>
                <div class="admin-stat-card"><div class="stat-number" id="statActivePackages">-</div><div class="stat-label">Active</div></div>
                <div class="admin-stat-card"><div class="stat-number" id="statHighlighted">-</div><div class="stat-label">Highlighted</div></div>
            </div>

            <!-- Pricing Toolbar -->
            <div class="admin-toolbar">
                <div style="display:flex;align-items:center;gap:0.75rem;">
                    <h3 style="margin:0;font-size:1rem;color:var(--text-white);font-weight:600;"><i class="fas fa-tag" style="color:var(--header-color);margin-right:0.4rem;"></i> Service Packages</h3>
                    <span style="font-size:0.8rem;color:var(--text-muted);">Manage your pricing cards on the Services page</span>
                </div>
                <div style="display:flex;gap:0.5rem;">
                    <button class="btn-ttb btn-ttb-primary" style="font-size:0.85rem;padding:0.55rem 1.2rem;" onclick="openAddPackageModal()"><i class="fas fa-plus"></i> Add Package</button>
                </div>
            </div>

            <!-- Pricing Cards Grid (admin preview) -->
            <div class="pricing-admin-grid" id="pricingGrid">
                <div style="text-align:center;padding:3rem;opacity:0.5;">
                    <i class="fas fa-spinner fa-spin" style="font-size:1.5rem;color:var(--text-muted);"></i>
                    <p style="color:var(--text-muted);margin-top:1rem;">Loading packages...</p>
                </div>
            </div>
        </div><!-- /pricingTab -->
    </div>

    <!-- ADD/EDIT SPOT MODAL -->
    <div class="admin-modal-backdrop" id="spotModal">
        <div class="admin-modal">
            <div class="admin-modal-header">
                <h2 id="modalTitle">Add New Spot</h2>
                <button class="admin-modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="admin-modal-body">
                <form id="spotForm" autocomplete="off">
                    <input type="hidden" id="spotId">
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Restaurant Name <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="spotName" placeholder="e.g. Joe's Pizza" required>
                        </div>
                        <div class="admin-form-group">
                            <label>Location (City, State) <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="spotLocation" placeholder="e.g. Haddonfield, NJ" required>
                        </div>
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>TikTok Video ID <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="spotTiktokId" placeholder="e.g. 7262868213384400171" required>
                            <p class="admin-form-help">The number at the end of the TikTok video URL</p>
                        </div>
                        <div class="admin-form-group">
                            <label>Discount</label>
                            <input type="text" class="admin-input" id="spotDiscount" placeholder="e.g. 15% Off">
                            <p class="admin-form-help">Leave blank if no discount</p>
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label>Short Description</label>
                        <input type="text" class="admin-input" id="spotSnippet" placeholder="e.g. A South Jersey classic with great pub grub" maxlength="300">
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Logo / Image URL</label>
                            <input type="text" class="admin-input" id="spotLogoImage" placeholder="e.g. /Images/myLogo.png">
                            <p class="admin-form-help">Path to an image in /Images/ or a full URL</p>
                        </div>
                        <div class="admin-form-group">
                            <label>Logo Background Color</label>
                            <div style="display:flex;gap:0.5rem;align-items:center;">
                                <input type="color" id="spotLogoBgColorPicker" value="#ffffff" style="width:44px;height:38px;border:1px solid var(--glass-border);border-radius:var(--radius-sm);cursor:pointer;background:var(--glass);padding:2px;">
                                <input type="text" class="admin-input" id="spotLogoBgColor" placeholder="#ffffff" style="flex:1;" maxlength="9">
                            </div>
                            <p class="admin-form-help">Hex color behind the logo. Default is white. Use dark for white logos.</p>
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label>Food Background Image URL</label>
                        <input type="text" class="admin-input" id="spotFoodImage" placeholder="e.g. /Images/food/picALilli.jpg">
                        <p class="admin-form-help">Background image for carousel card. Leave blank for default gradient.</p>
                    </div>
                    <div class="admin-form-group">
                        <label>Tags</label>
                        <div class="tags-input-wrapper" id="tagsWrapper">
                            <input type="text" id="tagInput" placeholder="Type tag + Enter...">
                        </div>
                        <p class="admin-form-help">Press Enter or comma to add. Backspace to remove last.</p>
                    </div>
                    <div class="admin-form-group">
                        <label>Rating</label>
                        <div class="rating-slider-wrapper">
                            <input type="range" id="spotRating" min="0" max="10" step="0.5" value="8">
                            <div class="rating-display" id="ratingDisplay">8.0</div>
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label><i class="fas fa-search" style="color:var(--header-color);"></i> Address Lookup</label>
                        <div style="display:flex;gap:0.5rem;">
                            <input type="text" class="admin-input" id="addressSearch" placeholder="e.g. 123 Main St, Philadelphia, PA" style="flex:1;">
                            <button type="button" class="btn-ttb btn-ttb-primary" onclick="geocodeAddress()" style="font-size:0.85rem;padding:0.55rem 1rem;white-space:nowrap;">
                                <i class="fas fa-map-marker-alt"></i> Lookup
                            </button>
                        </div>
                        <p class="admin-form-help">Enter an address to auto-fill coordinates and place the map marker</p>
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Latitude <span class="required">*</span></label>
                            <input type="number" class="admin-input" id="spotLat" step="0.0001" placeholder="e.g. 39.8390" required>
                        </div>
                        <div class="admin-form-group">
                            <label>Longitude <span class="required">*</span></label>
                            <input type="number" class="admin-input" id="spotLng" step="0.0001" placeholder="e.g. -75.0540" required>
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label><i class="fas fa-map-pin" style="color:var(--header-color);"></i> Pick on Map</label>
                        <div class="map-picker-container"><div id="mapPicker"></div></div>
                        <p class="map-picker-hint"><i class="fas fa-mouse-pointer"></i> Click the map to set coordinates</p>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn-ttb btn-ttb-outline" onclick="closeModal()" style="font-size:0.9rem;">Cancel</button>
                <button class="btn-ttb btn-ttb-primary" id="saveSpotBtn" onclick="saveSpot()" style="font-size:0.9rem;">
                    <i class="fas fa-save"></i> <span>Save Spot</span>
                </button>
            </div>
        </div>
    </div>

    <!-- CONFIRM DIALOG -->
    <div class="admin-modal-backdrop" id="confirmDialog">
        <div class="confirm-dialog">
            <h3 id="confirmTitle">Delete Spot?</h3>
            <p id="confirmMessage">This action cannot be undone.</p>
            <div class="btn-row">
                <button class="btn-ttb btn-ttb-outline" onclick="closeConfirm()" style="font-size:0.9rem;">Cancel</button>
                <button class="btn-ttb btn-danger" id="confirmBtn" style="font-size:0.9rem;"><i class="fas fa-trash-alt"></i> Delete</button>
            </div>
        </div>
    </div>

    <!-- TIKTOK IMPORT MODAL -->
    <div class="admin-modal-backdrop" id="importModal">
        <div class="admin-modal" style="max-width:700px;">
            <div class="admin-modal-header">
                <h2><i class="fab fa-tiktok" style="margin-right:0.5rem;"></i> Import from TikTok</h2>
                <button class="admin-modal-close" onclick="closeImportModal()">&times;</button>
            </div>
            <div class="admin-modal-body">
                <p style="color:var(--text-muted);font-size:0.9rem;margin-bottom:1rem;">
                    Paste one or more TikTok URLs (one per line). We'll auto-fill the restaurant name, video ID, and thumbnail. You just review and add the location + coordinates.
                </p>
                <div class="admin-form-group">
                    <label><i class="fas fa-link" style="color:var(--header-color);margin-right:0.3rem;"></i> TikTok URL(s)</label>
                    <textarea class="admin-input" id="importUrls" rows="4" placeholder="https://www.tiktok.com/@travelingtastebuds/video/7262868213384400171&#10;https://www.tiktok.com/@travelingtastebuds/video/7231695429392682286&#10;...paste as many as you want" style="resize:vertical;font-size:0.85rem;font-family:'Poppins',monospace;"></textarea>
                </div>
                <div style="display:flex;gap:0.5rem;margin-bottom:1.5rem;">
                    <button class="btn-ttb btn-ttb-primary" id="importFetchBtn" onclick="fetchTikTokData()" style="font-size:0.85rem;padding:0.55rem 1.2rem;">
                        <i class="fas fa-download"></i> <span>Fetch Data</span>
                    </button>
                    <span id="importStatus" style="color:var(--text-muted);font-size:0.85rem;display:flex;align-items:center;"></span>
                </div>
                <div id="importResults" style="display:none;">
                    <hr style="border-color:var(--glass-border);margin-bottom:1rem;">
                    <h3 style="font-size:1rem;margin-bottom:0.75rem;">Found Videos</h3>
                    <div id="importList"></div>
                </div>
            </div>
            <div class="admin-modal-footer" id="importFooter" style="display:none;">
                <button class="btn-ttb btn-ttb-outline" onclick="closeImportModal()" style="font-size:0.9rem;">Cancel</button>
                <button class="btn-ttb btn-ttb-primary" id="importAllBtn" onclick="importAllFetched()" style="font-size:0.9rem;">
                    <i class="fas fa-file-import"></i> <span>Import All to Form</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ADD/EDIT TESTIMONIAL MODAL -->
    <div class="admin-modal-backdrop" id="testimonialModal">
        <div class="admin-modal" style="max-width:650px;">
            <div class="admin-modal-header">
                <h2 id="testimonialModalTitle">Add Testimonial</h2>
                <button class="admin-modal-close" onclick="closeTestimonialModal()">&times;</button>
            </div>
            <div class="admin-modal-body">
                <form id="testimonialForm" autocomplete="off">
                    <input type="hidden" id="testimonialId">
                    <div class="admin-form-group">
                        <label><i class="fas fa-link" style="color:var(--header-color);margin-right:0.3rem;"></i> Link to Spot</label>
                        <div class="spot-search-wrapper" id="spotSearchWrapper">
                            <div class="spot-search-selected" id="spotSearchSelected" style="display:none;">
                                <img id="spotSearchSelectedLogo" src="" alt="" class="spot-search-logo">
                                <span id="spotSearchSelectedName"></span>
                                <button type="button" class="spot-search-clear" onclick="clearSpotLink()" title="Remove link">&times;</button>
                            </div>
                            <input type="text" class="admin-input" id="spotSearchInput" placeholder="Search spots by name..." autocomplete="off">
                            <div class="spot-search-dropdown" id="spotSearchDropdown"></div>
                        </div>
                        <input type="hidden" id="testimonialSpotId" value="">
                        <p class="admin-form-help">Optional. Linking auto-fills restaurant name, location, and shows the spot's logo on the card.</p>
                    </div>
                    <div class="admin-form-group">
                        <label>Quote <span class="required">*</span></label>
                        <textarea class="admin-input" id="testimonialQuote" rows="4" placeholder="What did the restaurant owner say about working with TTB?" required maxlength="500" style="resize:vertical;"></textarea>
                        <p class="admin-form-help"><span id="quoteCharCount">0</span>/500 characters</p>
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Author Name <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="testimonialAuthor" placeholder="e.g. Restaurant Owner" required maxlength="100">
                        </div>
                        <div class="admin-form-group">
                            <label>Restaurant Name</label>
                            <input type="text" class="admin-input" id="testimonialRestaurant" placeholder="e.g. Joe's Pizza" maxlength="100">
                        </div>
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Location <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="testimonialLocation" placeholder="e.g. South Jersey, NJ" required maxlength="100">
                        </div>
                        <div class="admin-form-group">
                            <label>Date</label>
                            <input type="text" class="admin-input" id="testimonialDate" placeholder="e.g. January 2025" maxlength="50">
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label>Rating</label>
                        <div class="star-rating-picker" id="starRatingPicker">
                            <i class="fas fa-star" data-value="1"></i>
                            <i class="fas fa-star" data-value="2"></i>
                            <i class="fas fa-star" data-value="3"></i>
                            <i class="fas fa-star" data-value="4"></i>
                            <i class="fas fa-star" data-value="5"></i>
                        </div>
                        <input type="hidden" id="testimonialRating" value="5">
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Result Highlight</label>
                            <input type="text" class="admin-input" id="testimonialResult" placeholder="e.g. Sold out the following weekend" maxlength="150">
                            <p class="admin-form-help">Short result or impact statement</p>
                        </div>
                        <div class="admin-form-group">
                            <label>Result Icon</label>
                            <select class="admin-input" id="testimonialResultIcon">
                                <option value="fas fa-chart-line">üìà Chart Line</option>
                                <option value="fas fa-users">üë• Users</option>
                                <option value="fas fa-eye">üëÅ Eye / Views</option>
                                <option value="fas fa-door-open">üö™ Door Open</option>
                                <option value="fas fa-shopping-bag">üõç Shopping Bag</option>
                                <option value="fas fa-map-marker-alt">üìç Map Marker</option>
                                <option value="fas fa-fire">üî• Fire</option>
                                <option value="fas fa-trophy">üèÜ Trophy</option>
                                <option value="fas fa-thumbs-up">üëç Thumbs Up</option>
                                <option value="fas fa-star">‚≠ê Star</option>
                                <option value="fas fa-bolt">‚ö° Bolt</option>
                                <option value="fas fa-heart">‚ù§ Heart</option>
                            </select>
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label><i class="fab fa-tiktok" style="color:var(--header-color);margin-right:0.3rem;"></i> TikTok URL</label>
                        <input type="text" class="admin-input" id="testimonialTiktokUrl" placeholder="https://www.tiktok.com/@..." maxlength="300">
                        <p class="admin-form-help">Link to the TikTok video for this restaurant (optional)</p>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn-ttb btn-ttb-outline" onclick="closeTestimonialModal()" style="font-size:0.9rem;">Cancel</button>
                <button class="btn-ttb btn-ttb-primary" id="saveTestimonialBtn" onclick="saveTestimonial()" style="font-size:0.9rem;">
                    <i class="fas fa-save"></i> <span>Save Testimonial</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ADD/EDIT PACKAGE MODAL -->
    <div class="admin-modal-backdrop" id="packageModal">
        <div class="admin-modal" style="max-width:700px;">
            <div class="admin-modal-header">
                <h2 id="packageModalTitle">Add Package</h2>
                <button class="admin-modal-close" onclick="closePackageModal()">&times;</button>
            </div>
            <div class="admin-modal-body">
                <form id="packageForm" autocomplete="off">
                    <input type="hidden" id="packageId">
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Package Name <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="packageName" placeholder="e.g. Main Course" required maxlength="100">
                        </div>
                        <div class="admin-form-group">
                            <label>Price <span class="required">*</span></label>
                            <input type="text" class="admin-input" id="packagePrice" placeholder="e.g. $1,500" required maxlength="50">
                        </div>
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Price Note</label>
                            <input type="text" class="admin-input" id="packagePriceNote" placeholder="e.g. *  or  +" maxlength="10">
                            <p class="admin-form-help">Symbol after price (e.g. * for footnote, + for starting at)</p>
                        </div>
                        <div class="admin-form-group">
                            <label>Sort Order</label>
                            <input type="number" class="admin-input" id="packageSortOrder" placeholder="0" value="0" min="0" max="100">
                            <p class="admin-form-help">Lower numbers appear first</p>
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label>Header Emojis</label>
                        <input type="text" class="admin-input" id="packageHeaderEmojis" placeholder="e.g. üçîüçü ... üåÆüçï" maxlength="50">
                        <p class="admin-form-help">Emojis displayed around the package name in the header. Leave blank for none.</p>
                    </div>
                    <div class="admin-form-group">
                        <label>Description</label>
                        <input type="text" class="admin-input" id="packageDescription" placeholder="Short description of the package" maxlength="300">
                    </div>
                    <div class="admin-form-group">
                        <label><i class="fas fa-list" style="color:var(--header-color);margin-right:0.3rem;"></i> Features <span class="required">*</span></label>
                        <div id="packageFeaturesContainer">
                            <!-- Feature rows added dynamically -->
                        </div>
                        <button type="button" class="btn-ttb btn-ttb-outline" style="font-size:0.8rem;padding:0.4rem 0.8rem;margin-top:0.5rem;" onclick="addFeatureRow()">
                            <i class="fas fa-plus"></i> Add Feature
                        </button>
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label>Button Text</label>
                            <input type="text" class="admin-input" id="packageButtonText" placeholder="Get Started" maxlength="50" value="Get Started">
                        </div>
                        <div class="admin-form-group">
                            <label>Button Link</label>
                            <input type="text" class="admin-input" id="packageButtonLink" placeholder="/contact?package=PackageName" maxlength="300">
                        </div>
                    </div>
                    <div class="admin-form-group">
                        <label>Footnote</label>
                        <input type="text" class="admin-input" id="packageFootnote" placeholder="e.g. *Food to be provided at no cost" maxlength="200">
                    </div>
                    <div class="admin-form-row">
                        <div class="admin-form-group">
                            <label style="display:flex;align-items:center;gap:0.5rem;">
                                <input type="checkbox" id="packageHighlighted" style="width:auto;margin:0;">
                                Highlighted (Accent Style)
                            </label>
                            <p class="admin-form-help">Highlighted packages get the orange accent border and styling</p>
                        </div>
                        <div class="admin-form-group">
                            <label style="display:flex;align-items:center;gap:0.5rem;">
                                <input type="checkbox" id="packageActive" checked style="width:auto;margin:0;">
                                Active (Visible on Site)
                            </label>
                            <p class="admin-form-help">Inactive packages are hidden from the services page</p>
                        </div>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn-ttb btn-ttb-outline" onclick="closePackageModal()" style="font-size:0.9rem;">Cancel</button>
                <button class="btn-ttb btn-ttb-primary" id="savePackageBtn" onclick="savePackage()" style="font-size:0.9rem;">
                    <i class="fas fa-save"></i> <span>Save Package</span>
                </button>
            </div>
        </div>
    </div>

    <script src="/js/ttb-config.js"></script>
    <script src="/js/ttb-data.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="/js/admin.js"></script>
</body>
</html>
