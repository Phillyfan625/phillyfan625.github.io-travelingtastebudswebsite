<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traveling Tastebuds | NJ & Philly Food Reviews</title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description"
        content="Traveling Tastebuds - South Jersey & Philadelphia's top food influencer. TikTok restaurant reviews, interactive food map, and influencer marketing for local restaurants.">
    <link rel="canonical" href="https://travelingtastebuds.org/">
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Traveling Tastebuds | NJ & Philly Food Reviews">
    <meta property="og:description"
        content="South Jersey & Philadelphia's top food influencer. TikTok restaurant reviews, interactive food map, and influencer marketing for local restaurants.">
    <meta property="og:image" content="https://travelingtastebuds.org/Images/ttbLogo.png">
    <meta property="og:url" content="https://travelingtastebuds.org/">
    <meta property="og:site_name" content="Traveling Tastebuds">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Traveling Tastebuds | NJ & Philly Food Reviews">
    <meta name="twitter:description"
        content="South Jersey & Philadelphia's top food influencer. TikTok restaurant reviews, interactive food map, and local restaurant marketing.">
    <meta name="twitter:image" content="https://travelingtastebuds.org/Images/ttbLogo.png">
    <!-- Structured Data -->
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Traveling Tastebuds",
            "alternateName": "TTB",
            "url": "https://travelingtastebuds.org",
            "logo": "https://travelingtastebuds.org/Images/ttbLogo.png",
            "image": "https://travelingtastebuds.org/Images/ttbLogo.png",
            "description": "South Jersey and Philadelphia's top food influencer. Restaurant reviews, TikTok content creation, and influencer marketing for local restaurants.",
            "foundingDate": "2020",
            "founder": {
                "@type": "Person",
                "name": "PJ"
            },
            "areaServed": [{
                "@type": "State",
                "name": "New Jersey"
            }, {
                "@type": "City",
                "name": "Philadelphia",
                "containedInPlace": {
                    "@type": "State",
                    "name": "Pennsylvania"
                }
            }],
            "sameAs": [
                "https://www.instagram.com/the.traveling.tastebuds/",
                "https://www.tiktok.com/@the.traveling.tastebuds",
                "https://www.youtube.com/@travelingtastebuds5208",
                "https://www.facebook.com/TTBReviews"
            ]
        }
    </script>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [{
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://travelingtastebuds.org/"
            }]
        }
    </script>
</head>

<body>
    <!-- Navbar -->
    <script src="/navbar-loader.js"></script>

    <!-- ===== HERO: TEXT + CAROUSEL SIDE BY SIDE ===== -->
    <section class="hero-split" id="latest-reviews">
        <div class="hero-split-inner">
            <div class="hero-text-side">
                <div class="hero-badge">
                    <i class="fas fa-fire"></i> NEW JERSEY'S #1 FOODIE GUIDE
                </div>
                <h1 class="hero-split-title">
                    Eat Good.<br>
                    <span class="text-sky">Travel Often.</span>
                </h1>
                <p class="hero-split-subtitle">
                    Discovering NJ & Philly's best eats, one bite at a time. Watch our TikTok reviews, explore the
                    interactive map, and find your next favorite spot.
                </p>
                <div class="hero-split-buttons">
                    <a href="/food-map" class="btn-ttb btn-ttb-primary">
                        <i class="fas fa-map-marked-alt"></i> View Map
                    </a>
                    <a href="/merch" class="btn-ttb btn-ttb-outline">
                        <i class="fas fa-shopping-bag"></i> Shop Merch
                    </a>
                </div>
                <div class="hero-split-stats">
                    <div class="hero-mini-stat">
                        <span class="hero-mini-number" id="spotCount">--</span>
                        <span class="hero-mini-label">Spots Reviewed</span>
                    </div>
                    <div class="hero-mini-stat">
                        <span class="hero-mini-number">300K+</span>
                        <span class="hero-mini-label">Total Followers</span>
                    </div>
                    <div class="hero-mini-stat">
                        <span class="hero-mini-number">150M+</span>
                        <span class="hero-mini-label">Total Views</span>
                    </div>
                </div>
            </div>
            <div class="hero-carousel-side">
                <button class="featured-nav-btn featured-prev" onclick="navigateCarousel(-1)" aria-label="Previous">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="featured-nav-btn featured-next" onclick="navigateCarousel(1)" aria-label="Next">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div class="hero-carousel-wrapper">
                    <div class="featured-carousel-track" id="featuredCarousel">
                        <!-- Cards populated by JavaScript -->
                    </div>
                </div>
                <div class="featured-carousel-dots" id="carouselDots">
                    <!-- Dots populated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- ===== INTERACTIVE MAP TEASER ===== -->
    <section class="map-teaser-section">
        <div class="container">
            <h2 class="section-title">Explore the Food Map</h2>
            <p class="section-subtitle">Every spot we've reviewed, pinned on an interactive map. Find your next meal.
            </p>
            <hr class="section-divider">
            <div class="map-teaser-card">
                <div class="map-teaser-preview">
                    <div id="mapTeaserPreview"></div>
                    <div class="map-teaser-overlay">
                        <a href="/food-map" class="btn-ttb btn-ttb-primary">
                            <i class="fas fa-expand"></i> Open Full Map
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== DISCOUNT PARTNERS (de-emphasized, horizontal scroll) ===== -->
    <section class="partners-section">
        <div class="container">
            <h2 class="section-title">Partner Discounts</h2>
            <p class="section-subtitle">Rock the TTB merch and get exclusive deals at these local favorites</p>
            <hr class="section-divider">
        </div>
        <div class="container">
            <div class="partners-scroll" id="partnersScroll">
                <!-- Populated by JavaScript -->
            </div>
            <div class="text-center mt-3">
                <a href="/merch" class="btn-ttb btn-ttb-accent" style="font-size: 0.9rem;">
                    <i class="fas fa-shopping-bag"></i> Shop TTB Merch
                </a>
            </div>
        </div>
    </section>

    <!-- ===== TIKTOK VIDEO OVERLAY ===== -->
    <div class="tiktok-overlay" id="tiktokOverlay">
        <div class="tiktok-overlay-backdrop" id="tiktokOverlayBackdrop"></div>
        <div class="tiktok-overlay-content">
            <div class="tiktok-overlay-header">
                <span class="tiktok-overlay-title" id="tiktokOverlayTitle">TikTok Review</span>
                <button class="tiktok-overlay-close" id="tiktokOverlayClose" aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="tiktok-overlay-frame">
                <div class="tiktok-overlay-loader" id="tiktokOverlayLoader">
                    <div class="tiktok-overlay-spinner"></div>
                    <span>Loading review...</span>
                </div>
                <iframe id="tiktokOverlayIframe" allowfullscreen allow="encrypted-media"></iframe>
            </div>
            <div class="tiktok-overlay-nav">
                <button id="tiktokOverlayPrev" aria-label="Previous review">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span class="tiktok-overlay-counter" id="tiktokOverlayCounter">1 / 10</span>
                <button id="tiktokOverlayNext" aria-label="Next review">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- ===== QUESTION OF THE DAY ===== -->
    <div class="backdrop"></div>
    <div class="question-of-the-day-widget d-none">
        <div class="widgetHover">
            <div class="exitBtn"
                style="background-color: var(--background-color); color: var(--header-color); width: fit-content; border-radius: 50%; padding: 0px 6px; font-size: 0.8rem;">
                X</div>
            <div style="margin: 0 auto">
                <img style="max-width: 80px; display: block; margin: 0 auto;" src="/Images/ttbLogo.png"
                    alt="Traveling Tastebuds Logo" />
            </div>
            <div class="widgetText text-center">
                Foodie <br /> Question of the Day
            </div>
        </div>
    </div>
    <div class="question-of-the-day">
        <div class="questionExitBtn">X</div>
        <h3 class="qotdTitle">Question of the Day</h3>
        <img id="question-image" src="" style="max-width: 180px; border-radius: 12px;" alt="Question Image">
        <p class="question-text"></p>
        <div class="answer">
            <input type="ttbText" placeholder="Enter your answer..." />
            <button class="submit-button">Submit</button>
        </div>
        <div class="qotdContainer">
            <p class="feedback"></p>
            <p class="leaderboard" style="margin-bottom: 0px; padding: 8px"></p>
        </div>
    </div>
    <div class="widget-chevron-left" style="opacity: 0">&#x2190;</div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="/js/ttb-data.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script>
        // ========================================
        // FEATURED CAROUSEL - 3-card center-highlight
        // ========================================
        var currentIndex = 0;
        var carouselSpots = [];
        var autoAdvanceTimer = null;

        function buildFeaturedCarousel(spots) {
            carouselSpots = spots;
            var track = document.getElementById('featuredCarousel');
            var dotsContainer = document.getElementById('carouselDots');
            track.innerHTML = '';
            dotsContainer.innerHTML = '';

            var esc = TTBData.escapeHtml;
            var safeTikTok = TTBData.sanitizeTikTokId;

            spots.forEach(function (spot, i) {
                var card = document.createElement('div');
                card.className = 'featured-card';
                card.setAttribute('data-index', i);

                var hasFoodImg = spot.foodImage && spot.foodImage.trim() !== '';
                card.innerHTML =
                    '<div class="featured-card-media">' +
                    (hasFoodImg ? '<img src="' + esc(spot.foodImage) + '" alt="" class="featured-card-bg" loading="lazy">' : '') +
                    '<div class="featured-card-placeholder' + (hasFoodImg ? ' has-food-bg' : '') + '">' +
                    '<img src="' + esc(spot.logoImage || '/Images/ttbLogo.png') + '" alt="' + esc(spot.name) + '" class="featured-card-logo"' + (spot.logoBgColor ? ' style="background:' + esc(spot.logoBgColor) + ';"' : '') + '>' +
                    '<div class="featured-card-play-btn"><i class="fas fa-play" style="margin-left:2px;"></i></div>' +
                    '</div>' +
                    '<div class="featured-card-overlay">' +
                    '<span class="featured-card-name">' + esc(spot.name) + '</span>' +
                    (spot.discount ? '<span class="featured-card-discount"><i class="fas fa-tag"></i> ' + esc(spot.discount) + '</span>' : '') +
                    '</div>' +
                    '</div>';

                // Click: active card opens overlay, inactive cards navigate
                (function (index) {
                    card.addEventListener('click', function () {
                        if (index === currentIndex) {
                            openTikTokOverlay(index);
                        } else {
                            navigateToIndex(index);
                        }
                    });
                })(i);

                track.appendChild(card);

                // Dot
                var dot = document.createElement('button');
                dot.className = 'carousel-dot' + (i === 0 ? ' active' : '');
                dot.setAttribute('aria-label', 'Go to slide ' + (i + 1));
                (function (index) {
                    dot.addEventListener('click', function () {
                        navigateToIndex(index);
                    });
                })(i);
                dotsContainer.appendChild(dot);
            });

            // Set initial positions
            updateCardPositions();

            // Start auto-advance
            startAutoAdvance();

            // Touch/swipe support
            var startX = 0;
            var threshold = 50;
            track.addEventListener('touchstart', function (e) {
                startX = e.touches[0].clientX;
            }, {
                passive: true
            });
            track.addEventListener('touchend', function (e) {
                var diff = startX - e.changedTouches[0].clientX;
                if (Math.abs(diff) > threshold) {
                    navigateCarousel(diff > 0 ? 1 : -1);
                }
            }, {
                passive: true
            });

            // Pause auto-advance on hover
            track.addEventListener('mouseenter', function () {
                stopAutoAdvance();
            });
            track.addEventListener('mouseleave', function () {
                startAutoAdvance();
            });
        }

        function navigateCarousel(direction) {
            var newIndex = currentIndex + direction;
            if (newIndex < 0) newIndex = carouselSpots.length - 1;
            if (newIndex >= carouselSpots.length) newIndex = 0;
            navigateToIndex(newIndex);
        }

        function navigateToIndex(index) {
            currentIndex = index;

            // Update dots
            var dots = document.querySelectorAll('.carousel-dot');
            dots.forEach(function (dot, i) {
                dot.classList.toggle('active', i === index);
            });

            updateCardPositions();

            // Reset auto-advance timer
            stopAutoAdvance();
            startAutoAdvance();
        }

        function updateCardPositions() {
            var cards = document.querySelectorAll('.featured-card');
            var total = carouselSpots.length;
            var prevIdx = (currentIndex - 1 + total) % total;
            var nextIdx = (currentIndex + 1) % total;

            cards.forEach(function (card, i) {
                card.classList.remove('position-left', 'position-center', 'position-right');
                if (i === prevIdx) {
                    card.classList.add('position-left');
                } else if (i === currentIndex) {
                    card.classList.add('position-center');
                } else if (i === nextIdx) {
                    card.classList.add('position-right');
                }
            });
        }

        function startAutoAdvance() {
            stopAutoAdvance();
            autoAdvanceTimer = setInterval(function () {
                navigateCarousel(1);
            }, 6000);
        }

        function stopAutoAdvance() {
            if (autoAdvanceTimer) {
                clearInterval(autoAdvanceTimer);
                autoAdvanceTimer = null;
            }
        }

        // Handle window resize
        window.addEventListener('resize', function () {
            updateCardPositions();
        });

        // ========================================
        // LOAD ALL DATA DYNAMICALLY
        // ========================================
        (async function loadHomepage() {
            // Show skeleton loaders in carousel
            var track = document.getElementById('featuredCarousel');
            var skelPositions = ['position-left', 'position-center', 'position-right'];
            track.innerHTML = skelPositions.map(function (pos) {
                return '<div class="featured-card ' + pos + '">' +
                    '<div class="featured-card-media"><div class="skeleton" style="width:100%;height:100%;position:absolute;inset:0;"></div></div>' +
                    '</div>';
            }).join('');

            var spots = [];
            try {
                spots = await TTBData.getSpots();
            } catch (err) {
                console.error('Failed to load spots:', err);
                track.innerHTML = '<p style="color:var(--text-muted);padding:2rem;text-align:center;">Could not load reviews right now. Please refresh the page.</p>';
                return;
            }

            if (!spots.length) {
                track.innerHTML = '<p style="color:var(--text-muted);padding:2rem;text-align:center;">No reviews yet â€” check back soon!</p>';
                return;
            }

            // Build the featured carousel
            buildFeaturedCarousel(spots);

            // Spot count stat
            document.getElementById('spotCount').textContent = spots.length + '+';

            // Map teaser
            var teaserMap = L.map('mapTeaserPreview', {
                zoomControl: false,
                scrollWheelZoom: false,
                dragging: false,
                touchZoom: false,
                doubleClickZoom: false,
                attributionControl: false
            }).setView([39.83, -75.10], 10);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; OpenStreetMap &copy; CARTO'
            }).addTo(teaserMap);

            var teaserIcon = L.divIcon({
                className: 'custom-marker',
                html: '<div style="width:14px;height:14px;background:#1e40af;border-radius:50%;border:2px solid white;box-shadow:0 2px 8px rgba(0,0,0,0.15);"></div>',
                iconSize: [14, 14],
                iconAnchor: [7, 7]
            });

            spots.forEach(function (spot) {
                if (spot.lat && spot.lng) L.marker([spot.lat, spot.lng], {
                    icon: teaserIcon
                }).addTo(teaserMap);
            });

            // Partner discounts
            var esc = TTBData.escapeHtml;
            var safeTikTok = TTBData.sanitizeTikTokId;
            var partnersScroll = document.getElementById('partnersScroll');
            partnersScroll.innerHTML = '';
            spots.filter(function (s) {
                return s.discount;
            }).forEach(function (spot) {
                var card = document.createElement('div');
                card.className = 'partner-card';
                card.innerHTML =
                    '<img src="' + esc(spot.logoImage || '') + '" alt="' + esc(spot.name) + '"' + (spot.logoBgColor ? ' style="background:' + esc(spot.logoBgColor) + '; padding:6px;"' : '') + '>' +
                    '<div class="partner-card-name">' + esc(spot.name) + '</div>' +
                    '<div class="partner-card-discount">' + esc(spot.discount) + '</div>';
                card.addEventListener('click', function () {
                    openTikTokModal(safeTikTok(spot.tiktokId), spot.name);
                });
                partnersScroll.appendChild(card);
            });
        })();

        // ========================================
        // TIKTOK OVERLAY
        // ========================================
        function openTikTokOverlay(spotIndex) {
            var spot = carouselSpots[spotIndex];
            if (!spot) return;

            var overlay = document.getElementById('tiktokOverlay');
            var iframe = document.getElementById('tiktokOverlayIframe');
            var loader = document.getElementById('tiktokOverlayLoader');
            var title = document.getElementById('tiktokOverlayTitle');
            var counter = document.getElementById('tiktokOverlayCounter');

            // Set content
            title.textContent = spot.name;
            counter.textContent = (spotIndex + 1) + ' / ' + carouselSpots.length;
            overlay.setAttribute('data-index', spotIndex);

            // Show loader, load iframe
            loader.classList.remove('hidden');
            iframe.src = 'https://www.tiktok.com/embed/' + TTBData.sanitizeTikTokId(spot.tiktokId);
            iframe.addEventListener('load', function () {
                loader.classList.add('hidden');
            }, {
                once: true
            });

            // Show overlay
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
            stopAutoAdvance();
        }

        function closeTikTokOverlay() {
            var overlay = document.getElementById('tiktokOverlay');
            var iframe = document.getElementById('tiktokOverlayIframe');

            overlay.classList.remove('active');
            document.body.style.overflow = '';
            iframe.removeAttribute('src');
            startAutoAdvance();
        }

        function navigateOverlay(direction) {
            var overlay = document.getElementById('tiktokOverlay');
            var idx = parseInt(overlay.getAttribute('data-index'), 10);
            var newIdx = idx + direction;
            if (newIdx < 0) newIdx = carouselSpots.length - 1;
            if (newIdx >= carouselSpots.length) newIdx = 0;

            // Also sync the carousel behind the overlay
            navigateToIndex(newIdx);
            openTikTokOverlay(newIdx);
        }

        // Overlay event listeners
        document.getElementById('tiktokOverlayClose').addEventListener('click', closeTikTokOverlay);
        document.getElementById('tiktokOverlayBackdrop').addEventListener('click', closeTikTokOverlay);
        document.getElementById('tiktokOverlayPrev').addEventListener('click', function () {
            navigateOverlay(-1);
        });
        document.getElementById('tiktokOverlayNext').addEventListener('click', function () {
            navigateOverlay(1);
        });
        document.addEventListener('keydown', function (e) {
            var overlay = document.getElementById('tiktokOverlay');
            if (!overlay.classList.contains('active')) return;
            if (e.key === 'Escape') closeTikTokOverlay();
            if (e.key === 'ArrowLeft') navigateOverlay(-1);
            if (e.key === 'ArrowRight') navigateOverlay(1);
        });

        // Legacy wrapper for partner cards section
        function openTikTokModal(videoId, name) {
            var idx = carouselSpots.findIndex(function (s) {
                return TTBData.sanitizeTikTokId(s.tiktokId) === TTBData.sanitizeTikTokId(videoId);
            });
            if (idx >= 0) {
                navigateToIndex(idx);
                openTikTokOverlay(idx);
            } else {
                // Fallback: open directly with video ID
                var overlay = document.getElementById('tiktokOverlay');
                var iframe = document.getElementById('tiktokOverlayIframe');
                var loader = document.getElementById('tiktokOverlayLoader');
                var title = document.getElementById('tiktokOverlayTitle');
                var counter = document.getElementById('tiktokOverlayCounter');

                title.textContent = name;
                counter.textContent = '';
                loader.classList.remove('hidden');
                iframe.src = 'https://www.tiktok.com/embed/' + TTBData.sanitizeTikTokId(videoId);
                iframe.addEventListener('load', function () {
                    loader.classList.add('hidden');
                }, {
                    once: true
                });
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        // ========================================
        // QUESTION OF THE DAY
        // ========================================
        const questionWidget = document.querySelector(".question-of-the-day-widget");
        const questionWidgetExitBtn = document.querySelector(".exitBtn");
        const questionPopUp = document.querySelector(".question-of-the-day");
        const questionBackDrop = document.querySelector(".backdrop");
        const widgetChevron = document.querySelector(".widget-chevron-left");

        questionWidgetExitBtn.addEventListener("click", (event) => {
            questionWidget.style.transform = "translateX(130%)";
            widgetChevron.style.opacity = "1";
            event.stopPropagation();
        });

        widgetChevron.addEventListener("click", () => {
            questionWidget.style.transform = "translateX(0)";
            widgetChevron.style.opacity = "0";
        });

        questionWidget.addEventListener("click", () => {
            document.querySelector(".question-of-the-day").style.display = "block";
            document.querySelector(".backdrop").style.display = "block";
        });

        const questionExitBtn = document.querySelector(".questionExitBtn");
        questionExitBtn.addEventListener("click", () => {
            document.querySelector(".question-of-the-day").style.display = "none";
            document.querySelector(".backdrop").style.display = "none";
        });

        const questions = [{
            question: "Where is this food from? (Hint: It's in Glassboro, New Jersey)",
            imageUrl: "/Images/qotdImages/peterAndSons.jpeg",
            acceptedAnswers: ["peter and sons", "peter & sons", "peter &amp; sons", "peter and son"],
            correctFeedback: "Correct! Way to go, you know your New Jersey food spots! Come back tomorrow for another question!",
            incorrectFeedback: "That's not quite it - the correct answer was Peter and Sons. Stay tuned for tomorrow's Question of the Day!",
        }];

        const today = new Date();
        const questionIndex = (today.getDate() - 1) % questions.length;
        const currentQuestion = questions[questionIndex].question;
        const currentImage = questions[questionIndex].imageUrl;

        document.querySelector(".question-text").innerText = currentQuestion;
        document.getElementById("question-image").src = currentImage;

        let score = parseInt(localStorage.getItem("score")) || 0;
        let answeredCorrectly = localStorage.getItem("answeredCorrectly");
        let previousQuestion = localStorage.getItem("question");

        if (previousQuestion !== currentQuestion) {
            answeredCorrectly = false;
            localStorage.setItem("answeredCorrectly", false);
        }

        const qotdContainer = document.querySelector(".qotdContainer");
        const submitButton = document.querySelector(".submit-button");
        const feedback = document.querySelector(".feedback");
        const leaderboard = document.querySelector(".leaderboard");

        submitButton.addEventListener("click", () => {
            const answer = document.querySelector('input[type="ttbText"]').value.trim().toLowerCase();
            const acceptedAnswers = questions[questionIndex].acceptedAnswers;

            if (answeredCorrectly === "true" || answeredCorrectly === true) {
                qotdContainer.style.display = "block";
                feedback.innerText = "You already got it right! Tune in tomorrow for another foodie question!";
                leaderboard.innerHTML = "You are on a " + score + " day streak! Way to go!";
            } else if (acceptedAnswers.includes(answer)) {
                qotdContainer.style.display = "block";
                feedback.innerText = questions[questionIndex].correctFeedback;
                score++;
                answeredCorrectly = true;
                leaderboard.innerHTML = "You are on a " + score + " day streak! Way to go!";
            } else {
                qotdContainer.style.display = "block";
                feedback.innerText = questions[questionIndex].incorrectFeedback;
            }

            localStorage.setItem("score", score);
            localStorage.setItem("question", currentQuestion);
            localStorage.setItem("answeredCorrectly", answeredCorrectly);
        });

        // ========================================
        // SCROLL ANIMATIONS
        // ========================================
        const observerOptions = {
            threshold: 0.1
        };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in-up').forEach(el => observer.observe(el));

        // ========================================
        // LOAD FOOTER
        // ========================================
        fetch('/footer.html')
            .then(r => r.text())
            .then(html => {
                document.getElementById('footer-container').innerHTML = html;
            })
            .catch(() => { });
    </script>
</body>

</html>