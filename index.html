<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traveling Tastebuds - Best Food in Jersey</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Chewy&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Restaurant Database -->
    <script src="/data/restaurants.js"></script>

    <!-- Restaurant Card Component -->
    <script src="/components/RestaurantCard.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #FFFFFF;
            color: #1e3a8a;
        }
        .brand-font {
            font-family: 'Chewy', cursive;
        }

        /* Hide Scrollbar but keep functionality */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .card-highlight {
            animation: pulse-border 2s infinite;
            border-color: #60a5fa;
            box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.3);
        }

        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(96, 165, 250, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(96, 165, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(96, 165, 250, 0); }
        }

        /* Smooth Scroll Behavior */
        html {
            scroll-behavior: smooth;
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#1e40af',
                            sky: '#60a5fa',
                            light: '#eff6ff',
                            white: '#ffffff'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { RestaurantCard, VideoModal } = window;
        const db = window.restaurantDB;

        // --- COMPONENTS ---

        const Logo = () => (
            <div className="w-14 h-14 relative group cursor-pointer">
                <img src="/Images/ttbLogo.png" alt="Traveling Tastebuds Logo" className="w-full h-full object-contain drop-shadow-md hover:scale-105 transition" />
            </div>
        );

        const Navbar = ({ setView, activeView }) => {
            useEffect(() => {
                lucide.createIcons();
            }, []);

            return (
                <nav className="sticky top-0 z-50 bg-white/95 backdrop-blur shadow-sm border-b border-gray-100">
                    <div className="max-w-7xl mx-auto px-4">
                        <div className="flex justify-between items-center h-20">
                            <div className="flex items-center gap-3 cursor-pointer" onClick={() => setView('home')}>
                                <Logo />
                                <div className="hidden md:block">
                                    <h1 className="brand-font text-3xl text-brand-blue leading-none">Traveling</h1>
                                    <h1 className="brand-font text-3xl text-brand-sky leading-none">Tastebuds</h1>
                                </div>
                            </div>

                            <div className="hidden md:flex gap-8 items-center">
                                {['Home', 'Reviews', 'Merch'].map((item) => (
                                    <button
                                        key={item}
                                        onClick={() => setView(item.toLowerCase())}
                                        className={`font-bold uppercase tracking-wide text-sm hover:text-brand-sky transition ${activeView === item.toLowerCase() ? 'text-brand-blue border-b-2 border-brand-blue' : 'text-gray-500'}`}
                                    >
                                        {item}
                                    </button>
                                ))}
                                <a href="https://www.tiktok.com/@the.traveling.tastebuds" target="_blank" rel="noopener noreferrer" className="bg-brand-blue text-white px-6 py-2 rounded-full font-bold hover:bg-blue-900 transition shadow-lg shadow-blue-200">
                                    Follow Us
                                </a>
                            </div>

                            <button className="md:hidden text-brand-blue">
                                <i data-lucide="menu" className="w-8 h-8"></i>
                            </button>
                        </div>
                    </div>
                </nav>
            );
        };

        const Hero = ({ setView, restaurants }) => {
            const featuredRestaurants = restaurants.filter(r => r.featured);
            const [startIndex, setStartIndex] = useState(0);
            const visibleCards = 3;

            useEffect(() => {
                lucide.createIcons();
            }, [startIndex]);

            const nextSlide = () => {
                setStartIndex((prev) => (prev + 1) % featuredRestaurants.length);
            };

            const prevSlide = () => {
                setStartIndex((prev) => (prev - 1 + featuredRestaurants.length) % featuredRestaurants.length);
            };

            const getVisibleSlides = () => {
                let slides = [];
                if (featuredRestaurants.length === 0) return [];
                for (let i = 0; i < visibleCards; i++) {
                    slides.push(featuredRestaurants[(startIndex + i) % featuredRestaurants.length]);
                }
                return slides;
            };

            return (
                <div className="relative overflow-hidden bg-white py-12 lg:py-24">
                    <div className="absolute top-0 right-0 -mr-20 -mt-20 w-[600px] h-[600px] bg-brand-light rounded-full blur-3xl opacity-60 z-0 pointer-events-none"></div>

                    <div className="max-w-7xl mx-auto px-4 flex flex-col lg:flex-row gap-16 items-center relative z-10">

                        <div className="text-center lg:text-left lg:w-5/12">
                            <h1 className="brand-font text-6xl lg:text-8xl text-brand-blue mb-6 leading-none tracking-tight">
                                Eat Good.<br/>
                                <span className="text-brand-sky">Travel Often.</span>
                            </h1>
                            <p className="text-xl text-gray-500 mb-8 leading-relaxed font-light max-w-lg mx-auto lg:mx-0">
                                Join PJ on a mission to find the best eats in Jersey. From hidden gems to 5-star plates, we review it all.
                            </p>
                            <div className="flex gap-4 justify-center lg:justify-start flex-wrap">
                                <button onClick={() => setView('reviews')} className="bg-brand-blue text-white px-10 py-4 rounded-xl font-bold text-lg shadow-xl hover:scale-105 transition flex items-center gap-3">
                                    <i data-lucide="map" className="w-6 h-6"></i> Explore Reviews
                                </button>
                                <button onClick={() => setView('merch')} className="text-brand-blue px-8 py-4 rounded-xl font-bold text-lg hover:bg-brand-light transition flex items-center gap-2">
                                    Shop Merch
                                </button>
                            </div>
                        </div>

                        <div className="relative lg:w-7/12 w-full h-[500px] flex items-center justify-center lg:justify-end">

                            {featuredRestaurants.length > 0 && (
                                <>
                                    <button onClick={prevSlide} className="absolute left-0 z-20 bg-white p-3 rounded-full shadow-lg text-brand-blue hover:bg-brand-sky hover:text-white transition">
                                        <i data-lucide="chevron-left" className="w-6 h-6"></i>
                                    </button>

                                    <div className="flex gap-6 overflow-hidden w-full justify-center py-10 px-4">
                                        {getVisibleSlides().map((restaurant, idx) => (
                                            <div
                                                key={`${restaurant.id}-${idx}`}
                                                className={`relative w-[260px] h-[420px] flex-shrink-0 rounded-3xl overflow-hidden shadow-2xl transition-all duration-500 transform bg-white border border-gray-100
                                                    ${idx === 1
                                                        ? 'scale-110 z-10 ring-4 ring-brand-sky ring-offset-2'
                                                        : 'scale-90 opacity-60 blur-[1px] grayscale'}`}
                                            >
                                                <div className="w-full h-full bg-gradient-to-br from-brand-light to-white flex items-center justify-center p-8">
                                                    <img src={restaurant.logo} className="max-w-full max-h-full object-contain" alt={restaurant.name} />
                                                </div>
                                                <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent">
                                                    <div className="absolute bottom-0 p-5 text-white w-full">
                                                        <p className="font-bold text-lg leading-tight mb-2 line-clamp-2">{restaurant.tiktokHeadline || restaurant.name}</p>
                                                        <div className="flex items-center gap-2 text-xs font-medium text-brand-sky uppercase tracking-wider">
                                                            <i data-lucide="play-circle" className="w-4 h-4"></i> Watch Review
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>

                                    <button onClick={nextSlide} className="absolute right-0 z-20 bg-white p-3 rounded-full shadow-lg text-brand-blue hover:bg-brand-sky hover:text-white transition">
                                        <i data-lucide="chevron-right" className="w-6 h-6"></i>
                                    </button>
                                </>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const Footer = () => {
            useEffect(() => {
                lucide.createIcons();
            }, []);

            return (
                <footer className="bg-brand-blue text-white py-12 border-t border-blue-800">
                    <div className="max-w-7xl mx-auto px-4 text-center">
                        <div className="w-16 h-16 mx-auto mb-6 bg-white rounded-full flex items-center justify-center p-2">
                            <img src="/Images/ttbLogo.png" alt="Logo" className="w-full h-full object-contain" />
                        </div>
                        <h2 className="brand-font text-3xl mb-2">Traveling Tastebuds</h2>
                        <p className="text-blue-200 mb-8 max-w-md mx-auto">
                            Exploring the best food in NJ and beyond. Tag us to get featured!
                        </p>
                        <div className="flex justify-center gap-6 mb-8 flex-wrap">
                            <a href="https://www.instagram.com/the.traveling.tastebuds/" target="_blank" rel="noopener noreferrer" className="text-white hover:text-brand-sky font-bold text-sm uppercase tracking-widest">Instagram</a>
                            <a href="https://www.tiktok.com/@the.traveling.tastebuds" target="_blank" rel="noopener noreferrer" className="text-white hover:text-brand-sky font-bold text-sm uppercase tracking-widest">TikTok</a>
                            <a href="https://www.youtube.com/@travelingtastebuds5208" target="_blank" rel="noopener noreferrer" className="text-white hover:text-brand-sky font-bold text-sm uppercase tracking-widest">YouTube</a>
                            <a href="https://www.facebook.com/TTBReviews" target="_blank" rel="noopener noreferrer" className="text-white hover:text-brand-sky font-bold text-sm uppercase tracking-widest">Facebook</a>
                        </div>
                        <p className="text-blue-400 text-xs">Â© 2025 Traveling Tastebuds. All rights reserved.</p>
                    </div>
                </footer>
            );
        };

        const App = () => {
            const [view, setView] = useState('home');
            const [modalRestaurant, setModalRestaurant] = useState(null);
            const [restaurants, setRestaurants] = useState([]);

            useEffect(() => {
                // Load restaurants from database
                setRestaurants(db.getAll());
                lucide.createIcons();
            }, []);

            useEffect(() => {
                lucide.createIcons();
            }, [view, restaurants]);

            // Listen for storage events to update when database changes
            useEffect(() => {
                const handleStorageChange = () => {
                    setRestaurants(db.getAll());
                };
                window.addEventListener('storage', handleStorageChange);
                return () => window.removeEventListener('storage', handleStorageChange);
            }, []);

            return (
                <div className="min-h-screen flex flex-col">
                    <Navbar setView={setView} activeView={view} />

                    {modalRestaurant && <VideoModal restaurant={modalRestaurant} onClose={() => setModalRestaurant(null)} />}

                    <main className="flex-grow">
                        {view === 'home' && (
                            <>
                                <Hero setView={setView} restaurants={restaurants} />
                                <div className="max-w-7xl mx-auto px-4 py-16">
                                    <div className="text-center mb-12">
                                        <h2 className="brand-font text-4xl text-brand-blue">Partner Perks</h2>
                                        <p className="text-gray-500 mt-2">Rock the tee, get the deal. It's that simple.</p>
                                    </div>

                                    {restaurants.length > 0 ? (
                                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                                            {restaurants.map(restaurant => (
                                                <RestaurantCard
                                                    key={restaurant.id}
                                                    restaurant={restaurant}
                                                    onOpenModal={setModalRestaurant}
                                                />
                                            ))}
                                        </div>
                                    ) : (
                                        <div className="text-center py-12">
                                            <p className="text-gray-500">No restaurants found. Visit the admin panel to add some!</p>
                                        </div>
                                    )}
                                </div>
                            </>
                        )}

                        {view === 'reviews' && (
                            <div className="max-w-7xl mx-auto px-4 py-24 text-center">
                                <h2 className="brand-font text-5xl text-brand-blue mb-4">Food Reviews</h2>
                                <p className="text-xl text-gray-500 mb-8">Interactive map and reviews!</p>
                                <button onClick={() => window.location.href = '/food-reviews'} className="bg-brand-blue text-white px-8 py-3 rounded-xl font-bold text-lg hover:scale-105 transition">
                                    View Reviews Map
                                </button>
                            </div>
                        )}

                        {view === 'merch' && (
                            <div className="max-w-7xl mx-auto px-4 py-24 text-center">
                                <h2 className="brand-font text-5xl text-brand-blue mb-4">Merch Store</h2>
                                <p className="text-xl text-gray-500 mb-8">Get your official Traveling Tastebuds gear!</p>
                                <button onClick={() => window.location.href = '/merch'} className="bg-brand-blue text-white px-8 py-3 rounded-xl font-bold text-lg hover:scale-105 transition">
                                    Shop Now
                                </button>
                            </div>
                        )}
                    </main>

                    <Footer />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
